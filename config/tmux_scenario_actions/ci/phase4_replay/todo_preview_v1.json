[
  {
    "type": "startup_preflight",
    "timeout": 20,
    "interval": 0.3,
    "ready_tokens": [
      "shortcuts"
    ],
    "kick_keys": [
      "Escape"
    ],
    "kick_every_polls": 1
  },
  {
    "type": "send",
    "text": "replay:config/cli_bridge_replays/phase4/todo_preview_smoke_v1.jsonl",
    "submit": true,
    "clear_first": true,
    "clear_mode": "ctrl_u"
  },
  {
    "type": "wait_until",
    "contains": [
      "TODOs:"
    ],
    "absent": [
      "Cannot read properties of undefined (reading 'length')",
      "buildModalStack.tsx:1084"
    ],
    "timeout": 20
  },
  {
    "type": "wait_for_quiet",
    "quiet_seconds": 1.5,
    "timeout": 30,
    "must_contain": [
      "Try \"fix typecheck errors\""
    ],
    "must_not_contain": [
      "Cannot read properties of undefined (reading 'length')",
      "buildModalStack.tsx:1084",
      "UnhandledPromiseRejection",
      "[phase4 replay target exited]",
      "[phase4 replay target] cli_bridge health check failed"
    ],
    "semantic_timeout": 5,
    "semantic_fail_fast": true,
    "must_contain_any": [
      "? shortcuts",
      "? for shortcuts"
    ]
  },
  {
    "type": "key",
    "key": "C-t",
    "wait": 0.2
  },
  {
    "type": "wait_for_quiet",
    "quiet_seconds": 1.5,
    "timeout": 30,
    "must_contain": [
      "Todos",
      "Try \"fix typecheck errors\""
    ],
    "must_not_contain": [
      "Cannot read properties of undefined (reading 'length')",
      "buildModalStack.tsx:1084",
      "UnhandledPromiseRejection",
      "[phase4 replay target exited]",
      "[phase4 replay target] cli_bridge health check failed"
    ],
    "semantic_timeout": 5,
    "semantic_fail_fast": true,
    "must_contain_any": [
      "? shortcuts",
      "? for shortcuts"
    ]
  },
  {
    "type": "key",
    "key": "C-t",
    "wait": 0.2
  },
  {
    "type": "wait_for_quiet",
    "quiet_seconds": 1.0,
    "timeout": 30,
    "must_contain": [
      "Try \"fix typecheck errors\""
    ],
    "must_not_contain": [
      "Cannot read properties of undefined (reading 'length')",
      "buildModalStack.tsx:1084",
      "UnhandledPromiseRejection",
      "[phase4 replay target exited]",
      "[phase4 replay target] cli_bridge health check failed"
    ],
    "semantic_timeout": 5,
    "semantic_fail_fast": true,
    "must_contain_any": [
      "? shortcuts",
      "? for shortcuts"
    ]
  }
]
